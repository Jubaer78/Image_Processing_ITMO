# Different Types of Distillation

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö CIFAR-10.

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å—Å–ª–µ–¥—É—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å —É—á–∏—Ç–µ–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –∑–Ω–∞–Ω–∏—è –≤ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å —É—á–µ–Ω–∏–∫–∞. –ú—ã —Ä–µ–∞–ª–∏–∑—É–µ–º –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —á–µ—Ç—ã—Ä–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –∑–Ω–∞–Ω–∏–π —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –º–µ—Ç—Ä–∏–∫ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π TensorBoard.

## üéØ –¶–µ–ª–∏

- –í–Ω–µ–¥—Ä–∏—Ç—å –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç—Ä–∏–∫ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü–æ–Ω—è—Ç—å, –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—á–∞ –∑–Ω–∞–Ω–∏–π —É–ª—É—á—à–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—É—é —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞


```
distillation-project/
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ teacher_net.py    # Large teacher model architecture
‚îÇ   ‚îú‚îÄ‚îÄ student_net.py    # Small student model architecture
‚îÇ   ‚îî‚îÄ‚îÄ student_regressor.py  # Student with feature regressor
‚îÇ
‚îú‚îÄ‚îÄ experiments/
‚îÇ   ‚îú‚îÄ‚îÄ experiment1_logits_distillation.py
‚îÇ   ‚îú‚îÄ‚îÄ experiment2_hidden_state_distillation.py
‚îÇ   ‚îú‚îÄ‚îÄ experiment3_regressor_distillation.py
‚îÇ   ‚îî‚îÄ‚îÄ bonus_combined_distillation.py
‚îÇ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ loss_functions.py
‚îÇ   ‚îî‚îÄ‚îÄ metrics.py
‚îÇ
‚îú‚îÄ‚îÄ runs/                 # TensorBoard logs
```

## üß™ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

### 1. –õ–æ–≥–∏—Ç-–¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä—è–º–æ–π –ø–µ—Ä–µ–Ω–æ—Å –∑–Ω–∞–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–º—è–≥—á–µ–Ω–Ω—ã—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
- **–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—Ç–µ—Ä—è KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º—è–≥–∫–∏–µ —Ü–µ–ª–∏ (–ª–æ–≥–∏—Ç—ã —É—á–∏—Ç–µ–ª—è) –∏ –∂–µ—Å—Ç–∫–∏–µ —Ü–µ–ª–∏ (–∏—Å—Ç–∏–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

### 2. –°–∫—Ä—ã—Ç–∞—è –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –ö–æ—Å–∏–Ω—É—Å–Ω–∞—è –ø–æ—Ç–µ—Ä—è —Å—Ö–æ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ —É—á–∏—Ç–µ–ª—è –∏ —É—á–µ–Ω–∏–∫–∞
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**: –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ª–æ–≥–∏—Ç-–ø–æ—Ç–µ—Ä—å –∏ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### 3. –î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—É—á–∞–µ–º—ã—Ö —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä–æ–≤ –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä—ã 1x1, –ø–æ—Ç–µ—Ä—è MSE –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏—Ç-–ø–æ—Ç–µ—Ä—è –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ—Ç–µ—Ä–∏

### 4. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è (–±–æ–Ω—É—Å)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —Å–æ—á–µ—Ç–∞—é—â–∏–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏–∏
- **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ—Ç–µ—Ä—å, –∏–º–∏—Ç–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**: –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏—Ö, –∫–æ—Å–∏–Ω—É—Å–Ω—ã—Ö –∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ç–µ—Ä—å

## üìä –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| Method | Accuracy | Parameters | Improvement |
|--------|----------|------------|-------------|
| Teacher Model | 85.02% | ~3.5M | - |
| Student Baseline | 78.58% | ~0.5M | Baseline |
| Logits Distillation | 78.91% | ~0.5M | +0.42% |
| Hidden State Distillation | 79.36% | ~0.5M | **+0.99%** |
| Regressor Distillation | 78.50% | ~0.6M | -0.10% |
| Combined Distillation | 78.56% | ~0.5M | -0.03% |

![Distillation Comparison](Images/Comparison.png)

## üîë –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è —Å–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** —Å —É–ª—É—á—à–µ–Ω–∏–µ–º –Ω–∞ 0,99% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∏—Å—Ö–æ–¥–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º
- **–õ–æ–≥–∏—Ç–Ω–∞—è –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è** –ø–æ–∫–∞–∑–∞–ª–∞ —É–º–µ—Ä–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ (+0,42%)
- **–ú–µ—Ç–æ–¥—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö** (—Ä–µ–≥—Ä–µ—Å—Å–æ—Ä –∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥), –ø–æ–∫–∞–∑–∞–ª–∏ –Ω–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ú–æ–¥–µ–ª—å —É—á–∏—Ç–µ–ª—è** –¥–æ—Å—Ç–∏–≥–ª–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ 85,02%, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–ª–æ —Å–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å

## üìà –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –õ—É—á—à–∏–π –º–µ—Ç–æ–¥: Hidden State Distillation

–ú–µ—Ç–æ–¥ **Hidden State Distillation** –¥–æ—Å—Ç–∏–≥ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è (+0,99%) –±–ª–∞–≥–æ–¥–∞—Ä—è:

- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏;
- —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—é –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∞ –Ω–µ —Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π;
- —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–µ–∂–¥—É –æ–±—Ä–∞–∑—Ü–∞–º–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# Clone the repository
git clone https://github.com/Jubaer78/different-types-distillation.git
cd different-types-distillation
```

# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
pip install -r requirements.txt

